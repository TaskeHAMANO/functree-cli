<?xml version="1.0" encoding="UTF-8"?>
<tool id="functree-cli" name="FuncTree" version="0.0.1">
    <description>A command-line based visualization tool for massive-scale omics data</description>
    <command><![CDATA[
    node $__tool_directory__/../bin/functree
    $args.sub_command
    -o $output

    #if $args.sub_command == "get":
        -d $args.source_database

    #elif $args.sub_command == "stats":
        -d $args.reference
        -m $args.stats.method
        #if $args.stats.method == "mannwhitneyu":
            -i $args.stats.input_1 $args.stats.input_2
        #else:
            -i $args.stats.input
        #end if

    #elif $args.sub_command == "create":
        -d $args.reference
        -i $args.input
        -f $args.format
    #end if

    #if $config.enable_config == "true":
        -c $config.config_data
    #end if
    ]]></command>
    <inputs>
        <conditional name="args">
            <param name="sub_command" type="select" label="Job command">
                <option value="get">Get reference data</option>
                <option value="stats">Statistical analysis</option>
                <option value="create">Create a visualization</option>
            </param>
            <when value="get">
                <param name="source_database" type="select" label="Source database">
                    <option value="kegg">KEGG</option>
                </param>
            </when>
            <when value="stats">
                <conditional name="stats">
                    <param name="method" type="select" label="Analysis method">
                         <option value="sum">Summation</option>
                         <option value="mean">Mean</option>
                         <option value="var">Variance</option>
                         <option value="mannwhitneyu">Mann-Whitney U test</option>
                    </param>
                    <when value="sum">
                        <param name="input" type="data" format="tabular" label="Input tabular file" />
                    </when>
                    <when value="mean">
                        <param name="input" type="data" format="tabular" label="Input tabular file" />
                    </when>
                    <when value="var">
                        <param name="input" type="data" format="tabular" label="Input tabular file" />
                    </when>
                    <when value="mannwhitneyu">
                        <param name="input_1" type="data" format="tabular" label="Input tabular file #1" />
                        <param name="input_2" type="data" format="tabular" label="Input tabular file #2" />
                    </when>
                </conditional>
                <param name="reference" type="data" format="json" label="Reference file" />
            </when>
            <when value="create">
                <param name="input" type="data" format="tabular" label="Input tabular file" />
                <param name="reference" type="data" format="json" label="Reference file" />
                <param name="format" type="select" label="Output image format">
                    <option value="svg">SVG</option>
                    <option value="html">HTML (interactive)</option>
                </param>
            </when>
        </conditional>
        <conditional name="config">
            <param name="enable_config" type="boolean" label="Specify a configuration file" />
            <when value="true">
                <param name="config_data" type="data" format="json" label="Configuration file" help="You can download example configuration from here: http://tsubaki.bio.titech.ac.jp/yyamate/functree-cli/raw/master/config/config.json"/>
            </when>
        </conditional>
    </inputs>
    <outputs>
        <data name="output" format="txt">
            <change_format>
                <when input="args.sub_command" value="get" format="json" />
                <when input="args.sub_command" value="stats" format="tabular" />
                <when input="args.sub_command" value="create" format="html" />
            </change_format>
        </data>
    </outputs>
    <help>
.. class:: infomark

**Description**

.. image:: http://www.bioviz.tokyo/functree2/image/logo.png
    :height: 125px

functree-cli is a command-line tool, which allows user to visualize, customize, and compute statistical test to understand the biological functionality of their omics data.

functree-cli allows user to map their omics data on to a pre-defined treemap, which is based on the KEGG BRITE (http://www.genome.jp/kegg/brite.html) or EnteroPathway (http://www.enteropathway.org/) database.

This allows user to quickly and comprehensively understand the functional potential of their data, and to develop further hypothesis and scientific insights.
    </help>
    <citations>
        <citation type="doi">10.1371/journal.pone.0126967</citation>
    </citations>

</tool>
